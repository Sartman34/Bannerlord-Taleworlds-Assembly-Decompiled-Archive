using System.Collections.Generic;
using System.Xml;
using TaleWorlds.ObjectSystem;

namespace TaleWorlds.Core;

public class BannerComponent : WeaponComponent
{
	public int BannerLevel { get; private set; }

	public BannerEffect BannerEffect { get; private set; }

	public BannerComponent(ItemObject item)
		: base(item)
	{
	}

	public override ItemComponent GetCopy()
	{
		return new BannerComponent(Item)
		{
			BannerLevel = BannerLevel,
			BannerEffect = BannerEffect
		};
	}

	public float GetBannerEffectBonus()
	{
		return BannerEffect.GetBonusAtLevel(BannerLevel);
	}

	public override void Deserialize(MBObjectManager objectManager, XmlNode node)
	{
		base.Deserialize(objectManager, node);
		BannerLevel = ((node.Attributes["banner_level"] == null) ? 1 : int.Parse(node.Attributes["banner_level"].Value));
		BannerEffect = MBObjectManager.Instance.GetObject<BannerEffect>(node.Attributes["effect"].Value);
	}

	internal static void AutoGeneratedStaticCollectObjectsBannerComponent(object o, List<object> collectedObjects)
	{
		((BannerComponent)o).AutoGeneratedInstanceCollectObjects(collectedObjects);
	}

	protected override void AutoGeneratedInstanceCollectObjects(List<object> collectedObjects)
	{
		base.AutoGeneratedInstanceCollectObjects(collectedObjects);
	}
}
